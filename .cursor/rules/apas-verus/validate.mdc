---
description: Validation commands for Verus verification
globs: 
alwaysApply: true
---

# Validation Modes

Always use the shell scripts. Do not type raw verus commands.

## validate (default) — full verification

When the user says "validate", run:

```bash
scripts/validate.sh
```

## dev_only_validate — foundation modules only

When the user says "dev_only_validate" or "dov", run with the dev_only feature.
This skips all chapters and verifies only foundation (Types, Concurrency, vstdplus):

```bash
scripts/validate.sh dev_only
```

To include specific chapters in dev_only mode, edit `src/lib.rs` and change their cfg from:
```rust
#[cfg(not(any(feature = "experiments_only", feature = "dev_only")))]
```
to:
```rust
#[cfg(not(feature = "experiments_only"))]
```

Remember to include transitive dependencies (see dependency table in lib.rs comments).

## V1 — validate once

When the user says "V1", run a single Verus verification. If working with `experiments_only`:

```bash
scripts/validate.sh exp
```

Otherwise, same as validate. Do not iterate or fix errors. Just run once, show the full output, and stop.

## Proof Holes

Use the wrapper scripts for hole queries (never call the binary directly):

```bash
scripts/holes.sh src/ChapNN/          # single chapter or file
scripts/all-holes-by-chap.sh          # all chapters, writes to analyses/ logs
```

Run `scripts/all-holes-by-chap.sh` after any rename or structural change that affects
proof hole analysis output. The per-chapter logs live at
`src/ChapNN/analyses/veracity-review-verus-proof-holes.log`.

## Analysis Scripts

All analysis scripts write per-chapter output to `src/ChapNN/analyses/`. Run them after
renames, structural changes, or when refreshing analysis baselines.

| Script | Output per chapter |
|---|---|
| `scripts/all-holes-by-chap.sh` | `veracity-review-verus-proof-holes.log` |
| `scripts/all-style-by-chap.sh` | `veracity-review-verus-style.log` |
| `scripts/all-fn-impls-by-chap.sh` | `veracity-review-module-fn-impls.{md,json}` |

## Running Suites

Run validate, rtt, and ptt **sequentially**, not in parallel. They compete for CPU and
memory, making all three slower than running them one at a time.
