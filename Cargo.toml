[package]
name = "apas-verus"
version = "0.1.0"
edition = "2024"

[package.metadata.verus]
verify = true

[features]
default = []
# Enable all modules for full verification (slower)
full_verify = []
# Build only experiments (skip chapter modules)
experiments_only = []

[dependencies]
vstd = "0.0.0-2025-08-12-1837"
verus_state_machines_macros = "0.0.0-2025-11-23-0053"

[lib]
path = "src/lib.rs"

[[test]]
name = "TestInsertionSortStEph"
path = "tests/Chap03/TestInsertionSortStEph.rs"
required-features = ["full_verify"]

[[test]]
name = "TestSetStEph"
path = "tests/Chap05/TestSetStEph.rs"

[[test]]
name = "TestRelationStEph"
path = "tests/Chap05/TestRelationStEph.rs"

[[test]]
name = "TestMappingStEph"
path = "tests/Chap05/TestMappingStEph.rs"

[[test]]
name = "TestKleeneStPer"
path = "tests/Chap05/TestKleeneStPer.rs"

[[test]]
name = "TestSetMtEph"
path = "tests/Chap05/TestSetMtEph.rs"

[[test]]
name = "test_total_order"
path = "tests/vstdplus/test_total_order.rs"

[[test]]
name = "test_partial_order"
path = "tests/vstdplus/test_partial_order.rs"

[[test]]
name = "test_feq"
path = "tests/vstdplus/test_feq.rs"

# Orphaned: test_checked_nat_with_checked_view

[[test]]
name = "TestDirGraphStEph"
path = "tests/Chap06/TestDirGraphStEph.rs"
required-features = ["full_verify"]

[[test]]
name = "TestDirGraphMtEph"
path = "tests/Chap06/TestDirGraphMtEph.rs"
required-features = ["full_verify"]

[[test]]
name = "TestUnDirGraphStEph"
path = "tests/Chap06/TestUnDirGraphStEph.rs"
required-features = ["full_verify"]

[[test]]
name = "TestLabDirGraphStEph"
path = "tests/Chap06/TestLabDirGraphStEph.rs"
required-features = ["full_verify"]

[[test]]
name = "TestLabUnDirGraphStEph"
path = "tests/Chap06/TestLabUnDirGraphStEph.rs"
required-features = ["full_verify"]

[[test]]
name = "TestWeightedDirGraphStEphU32"
path = "tests/Chap06/TestWeightedDirGraphStEphU32.rs"
required-features = ["full_verify"]

[[test]]
name = "TestParaPairs"
path = "tests/Chap11/TestParaPairs.rs"
required-features = ["full_verify"]

[[test]]
name = "TestFibonacciMt"
path = "tests/Chap11/TestFibonacciMt.rs"
required-features = ["full_verify"]

[[test]]
name = "test_threads_plus"
path = "tests/Chap02/test_threads_plus.rs"

[[test]]
name = "test_fibonacci_scheduler"
path = "tests/Chap02/test_fibonacci_scheduler.rs"
required-features = ["full_verify"]

[[test]]
name = "test_hf_scheduler"
path = "tests/Chap02/test_hf_scheduler.rs"


[[test]]
name = "test_exercise12_1"
path = "tests/Chap12/test_exercise12_1.rs"
required-features = ["full_verify"]

[[test]]
name = "test_exercise12_2"
path = "tests/Chap12/test_exercise12_2.rs"
required-features = ["full_verify"]

[[test]]
name = "test_exercise12_5"
path = "tests/Chap12/test_exercise12_5.rs"
required-features = ["full_verify"]

[[test]]
name = "TestMathSeq"
path = "tests/Chap17/TestMathSeq.rs"
required-features = ["full_verify"]

[[test]]
name = "TestArraySeq"
path = "tests/Chap18/TestArraySeq.rs"

[[test]]
name = "TestArraySeqMtPer"
path = "tests/Chap18/TestArraySeqMtPer.rs"

[[test]]
name = "TestArraySeqMtEph"
path = "tests/Chap18/TestArraySeqMtEph.rs"

[[test]]
name = "TestBalBinTreeStEph"
path = "tests/Chap23/TestBalBinTreeStEph.rs"

[[test]]
name = "TestPrimTreeSeqStPer"
path = "tests/Chap23/TestPrimTreeSeqStPer.rs"

[[test]]
name = "TestDivConReduceStPer"
path = "tests/Chap26/TestDivConReduceStPer.rs"

[[test]]
name = "TestMergeSortStPer"
path = "tests/Chap26/TestMergeSortStPer.rs"

[[test]]
name = "TestDivConReduceMtPer"
path = "tests/Chap26/TestDivConReduceMtPer.rs"

[[test]]
name = "TestMergeSortMtPer"
path = "tests/Chap26/TestMergeSortMtPer.rs"

[[test]]
name = "TestScanDCStPer"
path = "tests/Chap26/TestScanDCStPer.rs"

[[test]]
name = "TestScanDCMtPer"
path = "tests/Chap26/TestScanDCMtPer.rs"

[[test]]
name = "TestETSPStPer"
path = "tests/Chap26/TestETSPStPer.rs"

[[test]]
name = "TestETSPMtPer"
path = "tests/Chap26/TestETSPMtPer.rs"

# Experiments removed - use verus-proof-time-testing project instead
# [[test]]
# name = "test_verify_harness"
# path = "tests/experiments/test_verify_harness.rs"

# [[test]]
# name = "TestVerusKeepGhostAndTest"
# path = "tests/experiments/TestVerusKeepGhostAndTest.rs"

[[bench]]
name = "BenchInsertionSortStEph"
path = "benches/Chap03/BenchInsertionSortStEph.rs"
harness = false

[dev-dependencies]
criterion = { version = "0.5", features = ["html_reports"] }
# rust_verify_test_macros requires nightly - use verus-proof-time-testing project instead
# rust_verify_test_macros = { path = "/home/milnes/projects/verus/source/rust_verify_test_macros" }
which = "6"

[profile.release]
incremental = true

[lints.rust]
non_snake_case = "allow"
non_camel_case_types = "allow"
non_upper_case_globals = "allow"
unused_imports = "allow"
unused_variables = "allow"
dead_code = "allow"
unused_parens = "allow"
unexpected_cfgs = { level = "warn", check-cfg = ['cfg(verus_keep_ghost)', 'cfg(verus_keep_ghost_body)'] }

[lints.clippy]
module_inception = "allow"
type_complexity = "allow"

[workspace]
members = ["."]

# Use local Verus fork for vstd and state machines (for rust-analyzer navigation)
[patch.crates-io]
vstd = { path = "/home/milnes/projects/verus/source/vstd" }
verus_state_machines_macros = { path = "/home/milnes/projects/verus/source/state_machines_macros" }
